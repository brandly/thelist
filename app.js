var dependencies;angular.module("sc2.services",[]),angular.module("sc2.filters",[]),angular.module("sc2.directives",[]),dependencies=["sc2.services","sc2.filters","sc2.directives","ui.router"],angular.module("sc2",dependencies).config(["$stateProvider","$urlRouterProvider",function(e,r){return e.state("app",{url:"/",templateUrl:"views/app.html",controller:"MainCtrl"}),r.otherwise("/")}]);
angular.module("sc2").controller("MainCtrl",["$scope","$sc",function(r,e){return r.tracks=[],r.search={query:""},r.$watch("search.query",_.debounce(function(){return 0===r.search.query.length?r.tracks=[]:e.searchTracks(r.search.query,10).then(function(e){return console.log("TRACKS",e),r.tracks=e})},300)),r.getBiggerArt=function(r,e){return r?r.replace("large.jpg","t"+e+"x"+e+".jpg"):""}}]);
angular.module("sc2.directives").directive("playlist",["$sc","$interval",function(n,r){return{link:function(t){var u;return t.playlist=u=[],t.player={current:{},play:function(){var n;return(null!=(n=this.current.sound)?n.paused:void 0)?this.current.sound.play():u.length?this.playTrack(0):void 0},playTrack:function(t){var e;return null!=(e=this.current.sound)&&e.pause(),r.cancel(this.current.interval),this.current={track:u[t],index:t},n.streamTrack(this.current.track.id).then(function(n){return function(e){return console.log("GOT SOUND",e),n.current.track===u[t]?(e.play(),n.current.sound=e,n.current.interval=r(function(){return n.current.position=n.current.sound.position,n.current.sound.position===n.current.sound.duration?(console.log("FAILS",n.current.sound.failures),console.log("DURATION",n.current.sound.duration),console.log("POSITION",n.current.sound.position),n.next()):void 0},1e3)):void 0}}(this),function(n){return u[t].error=n})},pause:function(){var n;return null!=(n=this.current.sound)?n.pause():void 0},next:function(){var n;return this.playTrack(null!=this.current.sound&&(n=this.current.index+1,n!==u.length)?n:0)},prev:function(){var n;return this.playTrack(null!=this.current.sound&&(n=this.current.index-1,n>=0)?n:u.length-1)},seek:function(n){var r,t;return r=n*this.current.sound.duration,this.current.position=r,null!=(t=this.current.sound)?t.setPosition(r):void 0}}}}}]);
angular.module("sc2.directives").directive("seek",[function(){return{link:function(e,n){return n.on("click",function(n){var t,i;return t=n.offsetX/(null!=(i=n.target)?i.offsetWidth:void 0),t?e.player.seek(t):void 0})}}}]);
angular.module("sc2.services").service("$sc",["$q",function(e){return SC.initialize({client_id:"7f5d27e4fc4e7c52527da9a5ebda2668"}),{get:function(r,t){var n;return null==t&&(t={}),n=e.defer(),SC.get(r,t,function(e,r){return null!=r?n.reject(r):n.resolve(e)}),n.promise},getTracks:function(e){return this.get("/tracks",e)},searchTracks:function(e,r){return this.getTracks({q:e,limit:r})},streamTrack:function(r){var t;return t=e.defer(),SC.stream("/tracks/"+r,function(e,r){return null!=r?t.reject(r):t.resolve(e)}),t.promise}}}]);