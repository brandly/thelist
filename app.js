var dependencies;angular.module("sc2.services",[]),angular.module("sc2.filters",[]),angular.module("sc2.directives",[]),dependencies=["sc2.services","sc2.filters","sc2.directives","ui.router"],angular.module("sc2",dependencies).config(["$stateProvider","$urlRouterProvider",function(e,r){return e.state("app",{url:"/",templateUrl:"views/app.html",controller:"MainCtrl"}),r.otherwise("/")}]);
angular.module("sc2").controller("MainCtrl",["$scope","$sc",function(r,e){return r.tracks=[],r.search={query:"",url:""},r.$watch("search.query",_.debounce(function(){return 0===r.search.query.length?r.$apply(function(){return r.tracks=[]}):e.searchTracks(r.search.query,10).then(function(e){return console.log("TRACKS",e),r.tracks=e})},300)),Mousetrap.bind("space",function(e){return e.preventDefault(),r.player.togglePause()}),Mousetrap.bind("shift+right",function(){return r.player.next()}),Mousetrap.bind("shift+left",function(){return r.player.prev()}),r.$on("$destroy",function(){return Mousetrap.unbind("space"),Mousetrap.unbind("shift+right"),Mousetrap.unbind("shift+left")})}]);
angular.module("sc2.directives").directive("linkToTrack",[function(){return{replace:!0,scope:!0,templateUrl:"views/_link-to-track.html",controller:["$scope","$sc",function(n,r){return n.loading=!1,n.addTrackFromLink=function(e){return n.loading=!0,r.resolve(e).then(function(r){return"track"===r.kind?(n.playlist.push(r),n.search.url=""):void 0})["finally"](function(){return n.loading=!1})}}]}}]);
angular.module("sc2.directives").directive("playlist",["$sc","$interval",function(r,n){var t;return t=["uninitialised","loading","error","loaded"],{link:function(e){var u;return e.playlist=u=[],e.player={current:{},play:function(){var r;return(null!=(r=this.current.sound)?r.paused:void 0)?this.current.sound.play():u.length?this.playTrack(0):void 0},togglePause:function(){var r;return null!=(r=this.current.sound)?r.togglePause():void 0},playTrack:function(e){return this.stop(),this.current={track:u[e],index:e},r.streamTrack(this.current.track.id).then(function(r){return function(i){return console.log("GOT SOUND",i),r.current.track===u[e]?(i.play(),r.current.sound=i,r.current.interval=n(function(){if(r.current.position=r.current.sound.position,"loading"===t[r.current.sound.readyState]);else{if("error"===t[r.current.sound.readyState])return r.current.track.error=!0,r.next();if(r.current.sound.position===r.current.sound.duration)return r.next()}},1e3)):void 0}}(this),function(r){return u[e].error=r})},pause:function(){var r;return null!=(r=this.current.sound)?r.pause():void 0},next:function(){var r;return this.playTrack(null!=this.current.sound&&(r=this.current.index+1,r<u.length)?r:0)},prev:function(){var r;return this.playTrack(null!=this.current.sound&&(r=this.current.index-1,r>=0)?r:u.length-1)},seek:function(r){var n,t;return n=r*this.current.sound.duration,this.current.position=n,null!=(t=this.current.sound)?t.setPosition(n):void 0},stop:function(){var r;return n.cancel(this.current.interval),null!=(r=this.current.sound)&&r.stop(),this.current={}}}}}}]);
angular.module("sc2.directives").directive("seek",[function(){return{link:function(e,n){return n.on("click",function(n){var t,i;return t=n.offsetX/(null!=(i=n.target)?i.offsetWidth:void 0),t?e.player.seek(t):void 0})}}}]);
angular.module("sc2.filters").filter("resizeArt",function(){return function(r,e){return r?r.replace("large.jpg","t"+e+"x"+e+".jpg"):""}});
angular.module("sc2.services").service("$sc",["$q",function(e){return SC.initialize({client_id:"7f5d27e4fc4e7c52527da9a5ebda2668"}),{get:function(r,t){var n;return null==t&&(t={}),n=e.defer(),SC.get(r,t,function(e,r){return null!=r?n.reject(r):n.resolve(e)}),n.promise},getTracks:function(e){return this.get("/tracks",e)},searchTracks:function(e,r){return this.getTracks({q:e,limit:r})},streamTrack:function(r){var t;return t=e.defer(),SC.stream("/tracks/"+r,function(e,r){return null!=r?t.reject(r):t.resolve(e)}),t.promise},resolve:function(r){var t;return t=e.defer(),SC.get("/resolve",{url:r},function(e,r){return null!=r?t.reject(r):t.resolve(e)}),t.promise}}}]);